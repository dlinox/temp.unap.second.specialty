import{d as z,r as l,o as v,m as S,b as a,w as o,n as $,F as D,$ as k,x as F,z as w,c as A,a3 as N,i as T,t as U,a as R,h as u,f as M}from"./index-CnSf6oKy.js";import{V as _,a as G,b as y,f as j,c as E}from"./VCard-DBjaqxEr.js";import{V as L}from"./VDataTableServer-DF3-1OVB.js";import{a as q}from"./VSelect-BCWw9wq0.js";import{V as H}from"./VTextField-BqgT8V0_.js";import{V as J}from"./VForm-BSJNEsTb.js";import{V as K}from"./VCombobox-BPbtG2n_.js";import"./filter-D5F9XSXL.js";const O={class:"d-flex"},se=z({__name:"index",setup(Q){const m=l(!1),c=l(!1),f=l([]),V=l(10),I=l(0),P=l([]),p=l(""),g=l(null),x=l([]),n=l(!1),h=l(null),b=async({page:d,itemsPerPage:t,sortBy:e,search:r})=>{if(m.value=!0,r=r===null?"":r,r.length<3&&r.length>0){m.value=!1;return}let i=await(await k.post("https://data.segundas.unap.edu.pe/api/postulants/list",{page:d,itemsPerPage:t,sortBy:e,search:r},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data;f.value=i.headers,I.value=i.items.total,P.value=i.items.data,g.value=i.role,x.value=i.academicsPrograms,m.value=!1},s=l({programId:null,postulantId:null}),C=l(null),B=async()=>{let d=C.value,{valid:t}=await h.value.validate();if(!t)return;c.value=!0,n.value=!0,s.value.postulantId=d.Id;let e=await k.post("https://data.segundas.unap.edu.pe/api/update-academic-program",s.value,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e.data),e.data&&(n.value=!1,s.value.programId=null,s.value.postulantId=null,await b({page:1,itemsPerPage:10,sortBy:[],search:""})),c.value=!1};return(d,t)=>(v(),S(D,null,[a($,null,{default:o(()=>[a(F,{subtitle:"Gestion de postulantes",title:"Postulantes"}),a(w)]),_:1}),a(_,{rounded:"0",elevation:"0",class:"bg-light border"},{default:o(()=>[a(G,{class:"pa-2"},{default:o(()=>[a(y,{cols:"6"}),a(y,{cols:"6"},{default:o(()=>[a(H,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),label:"Buscar"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(L,{class:"border","items-per-page":V.value,"onUpdate:itemsPerPage":t[1]||(t[1]=e=>V.value=e),headers:f.value,"items-length":I.value,items:P.value,loading:m.value,search:p.value,"item-value":"Name","no-data-text":"No se encontraron registros","items-per-page-text":"Registros por página","loading-text":"Cargando registros","multi-sort":"","items-per-page-options":[5,10,25,50],"onUpdate:options":b},{"item.AcademicProgramName":o(({item:e})=>[g.value==="ADMIN"?(v(),A(u,{key:0,onClick:r=>(n.value=!0,C.value=e),color:"surface-variant",variant:"flat",icon:"mdi-swap-horizontal",size:"small",class:"mr-2"},null,8,["onClick"])):N("",!0),T(" "+U(e.AcademicProgramName),1)]),"item.actions":o(({item:e})=>[R("div",O,[a(u,{icon:"mdi-plus",size:"small",color:"primary",variant:"tonal",link:"",to:`/a/postulants/show/${e.Id}/generals`},null,8,["to"]),g.value==="ADMIN"?(v(),A(u,{key:0,color:"info",variant:"tonal",icon:"mdi-pencil",size:"small",class:"mr-2",link:"",to:`/a/postulants/edit/${e.Id}`},null,8,["to"])):N("",!0)])]),_:2},1032,["items-per-page","headers","items-length","items","loading","search"]),a(q,{"max-width":"500",persistent:"",modelValue:n.value,"onUpdate:modelValue":t[4]||(t[4]=e=>n.value=e)},{default:o(()=>[a(J,{onSubmit:M(B,["prevent"]),ref_key:"formRef",ref:h},{default:o(()=>[a(_,{title:"Actualizar programa académico",loading:c.value},{default:o(()=>[a(j,null,{default:o(()=>[a(K,{modelValue:s.value.programId,"onUpdate:modelValue":t[2]||(t[2]=e=>s.value.programId=e),items:x.value,"item-title":"Name","item-value":"Id",label:"Programa académico","return-object":!1,rules:[()=>!!s.value.programId||"Seleccione un programa académico"],outlined:"",dense:""},null,8,["modelValue","items","rules"])]),_:1}),a(E,null,{default:o(()=>[a(u,{variant:"tonal",text:"Cancelar",color:"red",onClick:t[3]||(t[3]=e=>n.value=!1),class:"px-4"}),a(w),a(u,{type:"submit",text:"Guardar"})]),_:1})]),_:1},8,["loading"])]),_:1},512)]),_:1},8,["modelValue"])],64))}});export{se as default};
