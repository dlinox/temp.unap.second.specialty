var O=Object.defineProperty;var z=(i,n,s)=>n in i?O(i,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[n]=s;var x=(i,n,s)=>(z(i,typeof n!="symbol"?n+"":n,s),s);import{d as R,h as Y,r,o as b,i as D,a as e,w as t,u as m,j as G,k as H,l as E,e as V,c as F,m as A,n as S,t as J,f as I,b as X,F as K,p as T,V as Q,g as W}from"./index-BjvFM0dB.js";import{P as Z,F as ee,_ as ae}from"./FileService-BmOxfSiA.js";import{i as y,a as te,b as le,c as oe,V as ne}from"./VForm-Bdc5a8pl.js";import{a as ue,V as se,b as k}from"./VSelect-C0D6RBTS.js";import{V as g,a as B,b as ie,c as d,d as _,f as re,e as me}from"./VTextField-CbCN9wXh.js";class de{constructor(){x(this,"http");const n="http://segundas.unap.pe/api";this.http=ue.create({baseURL:n,headers:{"Content-Type":"application/json"}})}async store(n){const s={secuencia:n.paymentId,monto:n.paymentAmount,fecha_pago:n.paymentDate,image_url:n.fileId,id_postulante:n.postulantId};return(await this.http.post("/pago",s)).data}}const pe=T("small",null," Voucher ",-1),ce=T("small",null," Ejemplo",-1),ve={key:0,class:"text-error ms-2"},fe=T("small",null,"Ya inicio la preinscripcion",-1),Ve=T("p",null,"Ya inicio la preinscripcion, desea continuar?",-1),ye=R({__name:"PostulantVoucher",emits:["onSuccess"],setup(i,{emit:n}){const s=Y(),p=new Z,U=new ee,P=new de,h=r(null),w=r(!1),c=r(!1),f=r(""),j=[{id:"001",name:"DOCUMENTO NACIONAL DE IDENTIDAD",shortName:"DNI"},{id:"004",name:"CARNET/CARNÉ DE EXTRANJERÍA",shortName:"CE"}],N=r(null),l=r({documentType:"001",documentNumber:"",paymentId:"",paymentDate:"",paymentAmount:"",paymentVoucher:null,postulantId:null,fileId:null}),v=r(""),M=u=>(v.value="",u?["image/jpeg","image/png","image/jpg","image/gif","image/svg","image/webp"].includes(u.type)?u.size>2e6?"El tamaño de la imagen no debe superar los 2MB":"":"Solo se permiten archivos de imagen (jpeg, png)":"El archivo es requerido"),C=async u=>{if(f.value="",u.length===8&&l.value.documentType==="001"){let a=await p.searchByDocument(l.value.documentType,u);a&&(f.value=a,c.value=!0)}else if(u.length===12&&l.value.documentType==="004"){let a=await p.searchByDocument(l.value.documentType,u);a&&(f.value=a,c.value=!0)}},$=()=>{s.push(`/p/convocatoria-2024/preinscripcion/${f.value}`)},q=async()=>{const{valid:u}=await N.value.validate();if(l.value.paymentVoucher===null){v.value="El archivo es requerido";return}if(v.value=M(l.value.paymentVoucher),!u)return;let a=await p.initzializePreinscription(l.value);l.value.postulantId=a.id;let o=await U.store(l.value);l.value.fileId=o.FileId;let L=await P.store(l.value);console.log(L)};return(u,a)=>(b(),D(K,null,[e(ne,{ref_key:"formRef",ref:N,class:"w-full",onSubmit:X(q,["prevent"])},{default:t(()=>[e(g,{width:"450",class:"mx-auto",rounded:"0",elevation:"0"},{default:t(()=>[e(B,null,{default:t(()=>[e(ie,{class:"mt-2"},{default:t(()=>[e(d,{cols:"12",md:"4"},{default:t(()=>[e(se,{modelValue:l.value.documentType,"onUpdate:modelValue":[a[0]||(a[0]=o=>l.value.documentType=o),a[1]||(a[1]=o=>C(l.value.documentNumber))],items:j,label:"Tipo de documento","item-title":"shortName","item-value":"id",rules:[m(y)],density:"compact"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"8",class:"pb-0"},{default:t(()=>[e(_,{modelValue:l.value.documentNumber,"onUpdate:modelValue":[a[2]||(a[2]=o=>l.value.documentNumber=o),C],label:"N° de documento",required:"",rules:[l.value.documentType==="001"?m(te):m(le)],autocomplete:"off",counter:l.value.documentType==="001"?8:12,maxLength:l.value.documentType==="001"?8:12},null,8,["modelValue","rules","counter","maxLength"])]),_:1}),e(d,{cols:"12",md:"12"},{default:t(()=>[e(_,{modelValue:l.value.paymentId,"onUpdate:modelValue":a[3]||(a[3]=o=>l.value.paymentId=o),label:"Serie",rules:[m(y),m(oe)]},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"12"},{default:t(()=>[e(_,{modelValue:l.value.paymentDate,"onUpdate:modelValue":a[4]||(a[4]=o=>l.value.paymentDate=o),label:"Fecha",type:"date",rules:[m(y)]},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"12"},{default:t(()=>[e(_,{modelValue:l.value.paymentAmount,"onUpdate:modelValue":a[5]||(a[5]=o=>l.value.paymentAmount=o),label:"Monto",rules:[m(y)]},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"12"},{default:t(()=>[e(G,{density:"compact"},{default:t(()=>[e(H,null,{default:t(()=>[pe]),_:1}),e(E),e(V,{"prepend-icon":"mdi-information-variant-circle-outline",density:"compact",onClick:a[6]||(a[6]=o=>w.value=!0)},{default:t(()=>[ce]),_:1})]),_:1}),e(g,{variant:"tonal",rounded:"0"},{default:t(()=>[e(ae,{"aspect-ratio":1,onOnCropper:a[7]||(a[7]=o=>(h.value=o.blob,l.value.paymentVoucher=o.file))}),h.value?(b(),F(A,{key:0,"aspect-ratio":16/9,src:h.value,height:"250",class:"border"},null,8,["src"])):S("",!0)]),_:1}),v.value?(b(),D("small",ve,J(v.value),1)):S("",!0)]),_:1}),e(d,{cols:"12"},{default:t(()=>[e(V,{type:"submit",variant:"flat",block:""},{default:t(()=>[I(" Guardar ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),e(k,{modelValue:w.value,"onUpdate:modelValue":a[8]||(a[8]=o=>w.value=o)},{default:t(()=>[e(g,{width:"300px",class:"mx-auto"},{default:t(()=>[e(A,{src:"http://www.osce.gob.pe/consultasenlinea/rnp/images/ClaveBANBIF.gif"})]),_:1})]),_:1},8,["modelValue"]),e(k,{modelValue:c.value,"onUpdate:modelValue":a[10]||(a[10]=o=>c.value=o)},{default:t(()=>[e(g,{width:"300px",class:"mx-auto"},{default:t(()=>[e(re,{class:"bg-primary"},{default:t(()=>[fe]),_:1}),e(B,null,{default:t(()=>[Ve]),_:1}),e(me,null,{default:t(()=>[e(V,{color:"red",onClick:a[9]||(a[9]=o=>c.value=!1)},{default:t(()=>[I("No")]),_:1}),e(E),e(V,{variant:"tonal",onClick:$},{default:t(()=>[I("Si")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ie=R({__name:"index",setup(i){return(async()=>{})(),(s,p)=>(b(),F(Q,{app:"",id:"inspire"},{default:t(()=>[e(W,{app:"",class:"mt-10"},{default:t(()=>[e(ye)]),_:1})]),_:1}))}});export{Ie as default};
